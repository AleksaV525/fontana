---
layout: layout.njk
pagination:
  data: products
  size: 1
  alias: proizvod
permalink: "proizvodi/{{ proizvod.id }}/index.html"
---

<section class="single-product-section content-offset">
    <div class="product-container">

        <div class="product-main-view">
            
            <div class="product-gallery">
                <div class="slider-container">
                    
                    {% for slika in proizvod.slike %}
                        <img class="slide" src="{{ slika }}" alt="{{ proizvod.naziv }}">
                    {% endfor %}

                    <button class="prev" onclick="plusSlides(-1, '{{ proizvod.id }}')">❮</button>
                    <button class="next" onclick="plusSlides(1, '{{ proizvod.id }}')">❯</button>
                    
                    <div class="slide-counter" id="slideCounter_{{ proizvod.id }}"></div>
                </div>
            </div>

            <div class="product-details">
                <h1 class="product-title">{{ proizvod.naziv }}</h1>
                
                <p class="short-description">{{ proizvod.kratak_opis or proizvod.opis | truncate(150) }}</p>
                
                <div class="product-action-box full-width-action">
                    <a href="/kontakt/?subject=Upit%20za%20proizvod:%20{{ proizvod.naziv | urlencode }}" class="contact-btn">
                        <i class="fas fa-paper-plane"></i> Pošalji Upit za Proizvod
                    </a>
                </div>
                
                <div class="direct-contact-info">
                    <p class="contact-highlight"><i class="fas fa-phone-alt"></i> Pozovite nas direktno:</p>
                    <a href="tel:+38163659831" class="contact-number">+381 63-659-831</a>
                </div>

                <div class="trust-icons">
                    <p><i class="fas fa-user-check"></i> Konsultacija sa ekspertom</p>
                    <p><i class="fas fa-certificate"></i> Garantovan kvalitet</p>
                </div>
            </div>
        </div>

        <div class="product-secondary-info">
            <h2 class="secondary-title">Detaljan opis proizvoda</h2>
            <div class="product-description-content">
                {{ proizvod.opis | safe }}
            </div>
            
            {% if proizvod.specifikacije %}
            <h2 class="secondary-title">Tehničke specifikacije</h2>
            <ul class="product-specs-list">
                {% for key, value in proizvod.specifikacije %}
                <li><span class="spec-label">{{ key }}:</span> <span>{{ value }}</span></li>
                {% endfor %}
            </ul>
            {% endif %}
        </div>

    </div>
</section>

<div id="lightboxModal" class="lightbox-modal">
    <span class="modal-close">&times;</span>
    <img class="modal-content" id="modalImage">
    <span class="modal-nav prev-btn">❮</span>
    <span class="modal-nav next-btn">❯</span>
</div>

<script>
    // Inicijalizacija klizača
    document.addEventListener('DOMContentLoaded', () => {
        const sliders = document.querySelectorAll('.slider-container');
        sliders.forEach(slider => {
            const slides = slider.querySelectorAll('.slide');
            if (slides.length > 0) {
                let id = '{{ proizvod.id }}';
                let initialIndex = 0;
                
                slider.dataset.slideIndex = initialIndex; 
                showSlides(initialIndex, id); 
            }
        });
    });

    function plusSlides(n, productId) {
        const sliderContainer = document.querySelector('.single-product-section .slider-container');
        if (!sliderContainer) return;
        
        let slideIndex = parseInt(sliderContainer.dataset.slideIndex) + n;
        showSlides(slideIndex, productId);
    }

    function showSlides(n, productId) {
        const slides = document.querySelectorAll('.single-product-section .slide');
        const sliderContainer = document.querySelector('.single-product-section .slider-container');
        const slideCounter = document.getElementById(`slideCounter_${productId}`);
        
        if (slides.length === 0) return;

        if (n >= slides.length) n = 0;
        if (n < 0) n = slides.length - 1;

        for (let i = 0; i < slides.length; i++) {
            slides[i].style.opacity = 0;
            slides[i].style.zIndex = 1;
        }
        
        slides[n].style.opacity = 1;
        slides[n].style.zIndex = 2;

        sliderContainer.dataset.slideIndex = n;
        
        if (slideCounter) {
             slideCounter.textContent = `${n + 1} / ${slides.length}`;
        }
    }

    
</script>