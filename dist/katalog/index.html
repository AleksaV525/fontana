<!DOCTYPE html>
<html lang="sr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="/styles/style.css">
  <title>Katalog</title>
</head>
<body>

 <header>
          <div class="logo"><img src="/img/logo-header.png" "></div>
          <nav>
  <div class="close-btn">&times;</div>

  <a href="/" 
     class="">
     Po캜etna
  </a>

  <a href="/katalog/" 
     class="active">
     Katalog
  </a>

  <a href="/o-nama/" 
     class="">
     O nama
  </a>

  <a href="/kontakt/" 
     class="">
     Kontakt
  </a>
</nav>

          <div class="hamburger">
            <div></div>
            <div></div>
            <div></div>
          </div>
       </header>

<main>
  
<section class="catalog-section content-offset">
    <div class="catalog-container">
        <h1 class="katalog-title">Istra쬴te na코 Katalog proizvoda</h1>

        <div class="catalog-layout">
            
            <aside class="filter-sidebar">
                <h2><i class="fas fa-filter"></i> Filteri</h2>
                
                <div class="filter-group">
                    <h3>Zapremina (Litara)</h3>
                    <div class="filter-options" id="filterZapremina">
                        <label class="filter-checkbox-label">
                            <input type="checkbox" name="zapremina" value="0-50"> Do 50 L
                        </label>
                        <label class="filter-checkbox-label">
                            <input type="checkbox" name="zapremina" value="51-100"> 51 - 100 L
                        </label>
                        <label class="filter-checkbox-label">
                            <input type="checkbox" name="zapremina" value="101-200"> 101 - 200 L
                        </label>
                    </div>
                </div>

                <div class="filter-group">
                    <h3>Snaga Greja캜a (W)</h3>
                    <div class="filter-options" id="filterSnaga">
                        <label class="filter-checkbox-label">
                            <input type="checkbox" name="snaga" value="1000-2000"> Do 2000 W
                        </label>
                        <label class="filter-checkbox-label">
                            <input type="checkbox" name="snaga" value="2001-3000"> 2001 - 3000 W
                        </label>
                        <label class="filter-checkbox-label">
                            <input type="checkbox" name="snaga" value="3001-9999"> Preko 3000 W
                        </label>
                    </div>
                </div>

                <div class="filter-group">
                    <h3>Tip Ugradnje</h3>
                    <div class="filter-options" id="filterUgradnja">
                        <label class="filter-checkbox-label">
                            <input type="checkbox" name="ugradnja" value="Vertikalna"> Vertikalna
                        </label>
                        <label class="filter-checkbox-label">
                            <input type="checkbox" name="ugradnja" value="Horizontalna"> Horizontalna
                        </label>
                    </div>
                </div>

            </aside>
            
            <div class="products-content">
                
                <div class="catalog-controls">
                    <input type="text" id="searchBar" placeholder="Pretra쬴 po nazivu..." class="search-input">
                    <div class="sort-controls">
                        <label for="sortSelect">Sortiraj po:</label>
                        <select id="sortSelect" class="sort-select">
                            <option value="nameAsc">Naziv (A-Z)</option>
                            <option value="nameDesc">Naziv (Z-A)</option>
                            <option value="zapreminaAsc">Zapremina (rastu캖e)</option>
                            <option value="zapreminaDesc">Zapremina (opadaju캖e)</option>
                            <option value="snagaDesc">Snaga (opadaju캖e)</option>
                        </select>
                    </div>
                </div>

                <div class="products-grid" id="productsGrid">
                </div>
            </div>

        </div> </div>
</section>


<script>
    // Globalna promenljiva za pra캖enje trenutnih filtera - prazna inicijalno
    let activeFilters = {
        zapremina: [],
        snaga: [],
        ugradnja: []
    };

    document.addEventListener('DOMContentLoaded', () => {
        // 1. PO캛ETNO U캛ITAVANJE PODATAKA
        // Klju캜na izmena: Koristimo 'products' jer je JSON u src/_data/products.json
        let allProducts;
        try {
            // Nunjucks renderuje sadr쬬j products.json kao JSON string
            allProducts = JSON.parse('[{"id":"bojler-1","naziv":"Bojler Standard 50L","opis":"Standardni horizontalni bojler zapremine 50 litara. Odli캜an izbor za manje porodice i vikendice, kombinuje efikasnost i pouzdanost.","zapremina":50,"tip_ugradnje":"Horizontalna","slika":"/img/S50.jpg","specifikacije":{"Snaga greja캜a (W)":2000,"Vreme zagrevanja (min)":90,"Materijal kazana":"Emajlirani 캜elik"},"slike":["/img/S50.jpg","/img/S60.jpg","/img/S80.jpg"]},{"id":"bojler-2","naziv":"Bojler Slim 80L","opis":"Vertikalni slim bojler zapremine 80 litara, idealan za kupatila sa ograni캜enim prostorom. Moderan dizajn i br쬰 zagrevanje.","zapremina":80,"tip_ugradnje":"Vertikalna (Slim)","slika":"/img/D-M50.jpg","specifikacije":{"Snaga greja캜a (W)":2000,"Pre캜nik (cm)":35,"Izolacija":"Poliuretanska pena"},"slike":["/img/D-M50.jpg","/img/D-M80.jpg","/img/S50.jpg"]},{"id":"bojler-3","naziv":"Bojler Kombinovani 100L","opis":"Bojler velikog kapaciteta sa kombinovanim grejanjem, pogodan za priklju캜enje na centralno grejanje. Pouzdanost i u코teda energije.","zapremina":100,"tip_ugradnje":"Vertikalna","slika":"/img/S80.jpg","specifikacije":{"Snaga greja캜a (W)":3000,"Kombinovano grejanje":"Da","Sigurnosni ventil":"Uklju캜en"},"slike":["/img/S80.jpg","/img/S50.jpg","/img/D-M50.jpg"]},{"id":"bojler-4","naziv":"Proto캜ni Bojler","opis":"Kompaktan proto캜ni bojler, idealan za brzo zagrevanje manje koli캜ine vode (npr. u kuhinji). Monta쬬 iznad ili ispod pulta.","zapremina":"Nema","tip_ugradnje":"Niska/Visoka monta쬬","slika":"/img/D-M50.jpg","specifikacije":{"Snaga greja캜a (W)":5000,"Tip":"Proto캜ni","Za코tita":"IP24"},"slike":["/img/D-M50.jpg","/img/S60.jpg","/img/S80.jpg"]},{"id":"bojler-5","naziv":"Bojler Elegance 60L","opis":"Bojler srednjeg kapaciteta sa elegantnim ku캖i코tem. Savr코ena ravnote쬬 izme캠u dimenzija i kapaciteta.","zapremina":60,"tip_ugradnje":"Vertikalna","slika":"/img/S60.jpg","specifikacije":{"Snaga greja캜a (W)":2000,"Garancija na kazan":"10 godina","Termostat":"Podesiv"},"slike":["/img/S60.jpg","/img/D-M80.jpg","/img/S50.jpg"]},{"id":"bojler-6","naziv":"Bojler Veliki 150L","opis":"Veliki bojler zapremine 150 litara za vi코eporodi캜ne ku캖e ili velike zahtevne prostore. Vrhunska izolacija.","zapremina":150,"tip_ugradnje":"Vertikalna","slika":"/img/S80.jpg","specifikacije":{"Snaga greja캜a (W)":3000,"Maksimalni pritisak":"6 bara","Ekspanziona posuda":"Uklj."},"slike":["/img/S80.jpg","/img/S60.jpg","/img/D-M50.jpg"]}]');
            
            if (!Array.isArray(allProducts) || allProducts.length === 0) {
                 console.warn("Proizvodi su prazni. Proverite sadr쬬j src/_data/products.json.");
                 allProducts = []; 
            }
        } catch (e) {
            console.error("KRITI캛NA GREKA: JSON parsovanje Nunjucks promenljive 'products' nije uspelo. Detalji:", e);
            allProducts = []; 
        }
        
        // Dohvatanje DOM elemenata
        const productsGrid = document.getElementById('productsGrid');
        const searchBar = document.getElementById('searchBar');
        const sortSelect = document.getElementById('sortSelect');
        const filterSidebar = document.querySelector('.filter-sidebar');

        // Uklanjanje nepostoje캖ih opcija za sortiranje (Cena)
        const priceOptions = ['priceAsc', 'priceDesc'];
        Array.from(sortSelect.options).forEach(option => {
            if (priceOptions.includes(option.value)) {
                option.remove();
            }
        });

        // Pomo캖na funkcija za parsovanje opsega (npr. "51-100" -> [51, 100])
        const parseRange = (rangeString) => {
            const parts = rangeString.split('-');
            return [parseInt(parts[0]), parseInt(parts[1]) || Infinity];
        };

        // Funkcija za renderovanje pojedina캜ne kartice
        const createProductCard = (item) => {
            const card = document.createElement('div');
            card.className = 'product-card';
            
            // Postavljanje data atributa za br쬿 manipulaciju/debug
            card.setAttribute('data-name', item.naziv.toLowerCase());
            card.setAttribute('data-zapremina', item.zapremina);
            card.setAttribute('data-snaga', item.specifikacije ? item.specifikacije["Snaga greja캜a (W)"] : null); // Sigurnosna provera
            card.setAttribute('data-ugradnja', item.tip_ugradnje);

            // A쬿riranje prikaza detalja proizvoda
            const zapreminaText = item.zapremina === 'Nema' || isNaN(item.zapremina) ? 'Proto캜ni' : `${item.zapremina} L`;
            const snagaText = item.specifikacije && item.specifikacije["Snaga greja캜a (W)"] ? `${item.specifikacije["Snaga greja캜a (W)"]} W` : 'N/A';

            card.innerHTML = `
                <a href="/proizvodi/${item.id}/" class="product-link">
                    <div class="product-image-wrapper">
                        <img src="${item.slika}" alt="${item.naziv}" class="product-img">
                    </div>
                    <div class="product-details">
                        <h3 class="product-name">${item.naziv}</h3>
                        <p class="product-info">Zapremina: <b>${zapreminaText}</b></p>
                        <p class="product-info">Snaga: <b>${snagaText}</b></p>
                        <button class="view-details-btn">Pogledaj detalje</button>
                    </div>
                </a>
            `;
            return card;
        };

        // Funkcija za sortiranje
        const sortProducts = (products, criteria) => {
             switch (criteria) {
                case 'nameAsc':
                    return products.sort((a, b) => a.naziv.localeCompare(b.naziv));
                case 'nameDesc':
                    return products.sort((a, b) => b.naziv.localeCompare(a.naziv));
                case 'zapreminaAsc':
                    return products.sort((a, b) => a.zapremina - b.zapremina);
                case 'zapreminaDesc':
                    return products.sort((a, b) => b.zapremina - a.zapremina);
                case 'snagaDesc':
                    // Koristimo 0 kao fallback za proizvode bez snage (proto캜ni, itd.)
                    return products.sort((a, b) => (b.specifikacije["Snaga greja캜a (W)"] || 0) - (a.specifikacije["Snaga greja캜a (W)"] || 0));
                default:
                    return products;
            }
        };

        // GLAVNA FUNKCIJA ZA FILTRIRANJE
        const applyFilters = (product) => {
            
            // 1. Pretraga po nazivu
            const searchTerm = searchBar.value.toLowerCase();
            if (!product.naziv.toLowerCase().includes(searchTerm)) {
                return false;
            }

            // 2. Filtriranje po zapremini
            if (activeFilters.zapremina.length > 0) {
                const zapremina = product.zapremina;
                let zapreminaMatch = false;

                if (zapremina !== 'Nema' && !isNaN(zapremina)) {
                    for (const range of activeFilters.zapremina) {
                        const [min, max] = parseRange(range);
                        if (zapremina >= min && zapremina <= max) {
                            zapreminaMatch = true;
                            break;
                        }
                    }
                }
                if (!zapreminaMatch) return false;
            }


            // 3. Filtriranje po snazi
            if (activeFilters.snaga.length > 0) {
                const snaga = product.specifikacije && product.specifikacije["Snaga greja캜a (W)"];
                let snagaMatch = false;

                if (snaga) {
                    for (const range of activeFilters.snaga) {
                        const [min, max] = parseRange(range);
                        if (snaga >= min && snaga <= max) {
                            snagaMatch = true;
                            break;
                        }
                    }
                }
                if (!snagaMatch) return false;
            }


            // 4. Filtriranje po tipu ugradnje
            if (activeFilters.ugradnja.length > 0) {
                const ugradnja = product.tip_ugradnje;
                // Proveravamo da li je neka od izabranih vrednosti sadr쬬na u ugradnji (Vertikalna, Horizontalna, Vertikalna (Slim)...)
                const ugradnjaMatch = activeFilters.ugradnja.some(filterVal => ugradnja.toLowerCase().includes(filterVal.toLowerCase()));
                
                if (!ugradnjaMatch) return false;
            }


            return true; // Pro코ao sve filtere
        };


        // Glavna funkcija za filtriranje i renderovanje
        const updateCatalog = () => {
            const sortValue = sortSelect.value;

            // 1. Filtriranje
            const filteredProducts = allProducts.filter(applyFilters);

            // 2. Sortiranje
            const sortedProducts = sortProducts(filteredProducts, sortValue);

            // 3. Renderovanje
            productsGrid.innerHTML = '';
            
            if (sortedProducts.length === 0) {
                productsGrid.innerHTML = '<p class="no-results">Nema prona캠enih proizvoda koji odgovaraju Va코em izboru.</p>';
                productsGrid.style.display = 'block';
            } else {
                sortedProducts.forEach(item => {
                    productsGrid.appendChild(createProductCard(item));
                });
                productsGrid.style.display = 'grid';
            }
        };

        // 4. Postavljanje Event Listeners
        searchBar.addEventListener('input', updateCatalog);
        sortSelect.addEventListener('change', updateCatalog);

        // Event Listener za Filter Sidebar
        filterSidebar.addEventListener('change', (e) => {
            if (e.target.type === 'checkbox') {
                const filterType = e.target.name; 
                const filterValue = e.target.value;

                // A쬿riranje globalnog activeFilters objekta
                if (e.target.checked) {
                    if (!activeFilters[filterType].includes(filterValue)) {
                        activeFilters[filterType].push(filterValue);
                    }
                } else {
                    activeFilters[filterType] = activeFilters[filterType].filter(val => val !== filterValue);
                }
                
                updateCatalog();
            }
        });

        // Inicijalno u캜itavanje kataloga
        updateCatalog();
    });
</script>
</main>

<footer class="site-footer">
  <div class="footer-content">

    <div class="footer-section">
      <h3>Kontakt</h3>
      <p>游늸 Janka Veselinovi캖a 30, Kragujevac</p>
      <p>游 063-659-831</p>
      <p>游 063-659-834</p>
      <p>游 034-6302-215</p>
      <p>九괦잺 markovico110011@gmail.com</p>
    </div>

  </div>

  <div class="footer-bottom">
    &copy; 2025 Fontana. Sva prava zadr쬬na.
  </div>
</footer>

</body>

<style>
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }
  
  body {
    font-family: 'Poppins', sans-serif;
    overflow-x: hidden;
  }

  header {
    width: 100%;
    position: fixed;
    top: 0;
    left: 0;
    z-index: 1000;
    display: flex;
    justify-content: space-between;
    align-items: center;
    background-position: center;
    transition: background-image 1s ease-in-out;
    padding: 20px 50px;
    background: rgba(0,0,0,0.4);
    backdrop-filter: blur(10px);
    transition: background 0.3s ease;
  }

  header.scrolled {
    background: rgba(0,0,0,0.85);
  }
  .logo img{
    width: 80px;
    border-radius: 7px;
  }
  .logo {
    font-size: 1.8rem;
    font-weight: 800;
    color: #007bff;
    letter-spacing: 1px;
    cursor: pointer;
    transition: transform 0.3s ease;
  }

  .logo:hover {
    transform: scale(1.1);
  }

  nav {
    display: flex;
    align-items: center;
    gap: 30px;
  }

  nav a {
    text-decoration: none;
    color: #fff;
    font-weight: 600;
    position: relative;
    transition: 0.3s;
  }
  .active{
    color: #4CAFFF;

  }
  nav a::after {
    content: '';
    position: absolute;
    width: 0%;
    height: 2px;
    background: #4CAFFF;
    left: 0;
    bottom: -5px;
    transition: 0.3s;
  }

  nav a:hover::after {
    width: 100%;
  }

  /* Hamburger */
  .hamburger {
    display: none;
    flex-direction: column;
    cursor: pointer;
    gap: 5px;
  }

  .hamburger div {
    width: 25px;
    height: 3px;
    background: #fff;
    transition: 0.4s;
  }

  /* Mobile Menu */
  @media (max-width: 900px) {
    nav {
      position: fixed;
      top: 0;
      right: -100%;
      height: 100vh;
      width: 250px;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      gap: 30px;
      background: rgba(0,0,0,0.95);
      transition: 0.5s;
    }

    nav.active {
      right: 0;
    }

    .hamburger {
      display: flex;
    }
  }
.close-btn {
  position: absolute;
  top: 20px;
  right: 20px;
  font-size: 28px;
  color: #fff;
  cursor: pointer;
  display: none;
}

@media (max-width: 900px) {
  .close-btn {
    display: block;
  }
}
/* ===== FOOTER ===== */
.site-footer {
  background: #0b0b0b;                 /* skoro crno */
  color: #dcdcdc;
  padding: 60px 40px 30px;
  margin-top: 80px;
}

.footer-content {
  max-width: 1300px;
  margin: 0 auto;
  display: flex;
  justify-content: space-between;
  flex-wrap: wrap;
}

.footer-section {
  min-width: 250px;
}

.footer-section h3 {
  font-size: 1.4rem;
  color: #4CAFFF;                      /* plavi akcenat */
  margin-bottom: 15px;
}

.footer-section p {
  margin: 5px 0;
  font-size: 1rem;
  color: #cfcfcf;
}

/* donja linija */
.footer-bottom {
  text-align: center;
  margin-top: 40px;
  padding-top: 20px;
  border-top: 1px solid rgba(255,255,255,0.1);
  font-size: 0.95rem;
  color: #9f9f9f;
}

/* Responsive */
@media (max-width: 700px) {
  .footer-content {
    flex-direction: column;
    gap: 30px;
  }
}


</style>
<script>

  // Hamburger toggle
  const hamburger = document.querySelector('.hamburger');
  const nav = document.querySelector('nav');
  const closeBtn = document.querySelector('.close-btn');
  
  hamburger.addEventListener('click', () => {
    nav.classList.add('active');
  });
  
  closeBtn.addEventListener('click', () => {
    nav.classList.remove('active');
  });

  // Change header background on scroll
  const header = document.querySelector('header');
  window.addEventListener('scroll', () => {
    if(window.scrollY > 50){
      header.classList.add('scrolled');
    } else {
      header.classList.remove('scrolled');
    }
  });

    /* KOD ZA SLANJE FORME */


</script>
</html>
